"use strict";

var _interopRequireDefault = require("@babel/runtime/helpers/interopRequireDefault");

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _typeof2 = _interopRequireDefault(require("@babel/runtime/helpers/typeof"));

var _fs = _interopRequireDefault(require("fs"));

function find_extensions(folder, ext, ret) {
  try {
    _fs["default"].accessSync(folder, _fs["default"].constants.R_OK);
  } catch (err) {
    return;
  }

  if (_fs["default"].statSync(folder).isDirectory() && folder.indexOf('node_modules') == -1 && _fs["default"].statSync(folder)["mode"] & 4) {
    _fs["default"].readdirSync(folder).forEach(function (file) {
      var tmp;
      if (Number.parseInt(folder.lastIndexOf('/') + 1) === folder.length) tmp = folder + file;else tmp = folder + '/' + file;
      if (_fs["default"].statSync(tmp).isDirectory()) find_extensions(tmp, ext, ret);else {
        var p = true;

        for (var i = 0; i < ext.length; i++) {
          if (ext[i].test(file)) p = false;
        }

        if (p) ret.push(folder + '/' + file);
      }
    });
  }
}

var make_available_extension = function make_available_extension(opts, ret) {
  if ((0, _typeof2["default"])(opts) == 'object' && (0, _typeof2["default"])(ret) == 'object') {
    var mas = opts.ext.split(',');

    for (var i = 0; i < mas.length; i++) {
      mas[i] = '.' + mas[i];
    }

    var res = [];

    for (var i = 0; i < mas.length; i++) {
      res[i] = new RegExp(mas[i] + '$');
    }

    find_extensions(process.cwd(), res, ret);
  }
};

var _default = {
  make_available_extension: make_available_extension
};
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9BUEkvTW9kdWxlcy9mbGFnRXh0LnRzIl0sIm5hbWVzIjpbImZpbmRfZXh0ZW5zaW9ucyIsImZvbGRlciIsImV4dCIsInJldCIsImZzIiwiYWNjZXNzU3luYyIsImNvbnN0YW50cyIsIlJfT0siLCJlcnIiLCJzdGF0U3luYyIsImlzRGlyZWN0b3J5IiwiaW5kZXhPZiIsInJlYWRkaXJTeW5jIiwiZm9yRWFjaCIsImZpbGUiLCJ0bXAiLCJOdW1iZXIiLCJwYXJzZUludCIsImxhc3RJbmRleE9mIiwibGVuZ3RoIiwicCIsImkiLCJ0ZXN0IiwicHVzaCIsIm1ha2VfYXZhaWxhYmxlX2V4dGVuc2lvbiIsIm9wdHMiLCJtYXMiLCJzcGxpdCIsInJlcyIsIlJlZ0V4cCIsInByb2Nlc3MiLCJjd2QiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQUE7O0FBRUEsU0FBU0EsZUFBVCxDQUF5QkMsTUFBekIsRUFBaUNDLEdBQWpDLEVBQXNDQyxHQUF0QyxFQUEyQztBQUN6QyxNQUFJO0FBQ0ZDLG1CQUFHQyxVQUFILENBQWNKLE1BQWQsRUFBc0JHLGVBQUdFLFNBQUgsQ0FBYUMsSUFBbkM7QUFDRCxHQUZELENBRUUsT0FBT0MsR0FBUCxFQUFZO0FBQ1o7QUFDRDs7QUFDRCxNQUFJSixlQUFHSyxRQUFILENBQVlSLE1BQVosRUFBb0JTLFdBQXBCLE1BQXFDVCxNQUFNLENBQUNVLE9BQVAsQ0FBZSxjQUFmLEtBQWtDLENBQUMsQ0FBeEUsSUFBOEVQLGVBQUdLLFFBQUgsQ0FBWVIsTUFBWixFQUFvQixNQUFwQixJQUE4QixDQUFoSCxFQUFvSDtBQUNsSEcsbUJBQUdRLFdBQUgsQ0FBZVgsTUFBZixFQUF1QlksT0FBdkIsQ0FBK0IsVUFBQUMsSUFBSSxFQUFJO0FBQ3JDLFVBQUlDLEdBQUo7QUFDQSxVQUFJQyxNQUFNLENBQUNDLFFBQVAsQ0FBZ0JoQixNQUFNLENBQUNpQixXQUFQLENBQW1CLEdBQW5CLElBQTBCLENBQTFDLE1BQWlEakIsTUFBTSxDQUFDa0IsTUFBNUQsRUFDRUosR0FBRyxHQUFHZCxNQUFNLEdBQUdhLElBQWYsQ0FERixLQUdFQyxHQUFHLEdBQUdkLE1BQU0sR0FBRyxHQUFULEdBQWVhLElBQXJCO0FBQ0YsVUFBSVYsZUFBR0ssUUFBSCxDQUFZTSxHQUFaLEVBQWlCTCxXQUFqQixFQUFKLEVBQ0VWLGVBQWUsQ0FBQ2UsR0FBRCxFQUFNYixHQUFOLEVBQVdDLEdBQVgsQ0FBZixDQURGLEtBRUs7QUFDSCxZQUFJaUIsQ0FBQyxHQUFHLElBQVI7O0FBQ0EsYUFBSyxJQUFJQyxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHbkIsR0FBRyxDQUFDaUIsTUFBeEIsRUFBZ0NFLENBQUMsRUFBakM7QUFDRSxjQUFJbkIsR0FBRyxDQUFDbUIsQ0FBRCxDQUFILENBQU9DLElBQVAsQ0FBWVIsSUFBWixDQUFKLEVBQ0VNLENBQUMsR0FBRyxLQUFKO0FBRko7O0FBR0EsWUFBSUEsQ0FBSixFQUNFakIsR0FBRyxDQUFDb0IsSUFBSixDQUFTdEIsTUFBTSxHQUFHLEdBQVQsR0FBZWEsSUFBeEI7QUFDSDtBQUNGLEtBaEJEO0FBaUJEO0FBQ0Y7O0FBRUQsSUFBTVUsd0JBQXdCLEdBQUcsU0FBU0Esd0JBQVQsQ0FBa0NDLElBQWxDLEVBQXdDdEIsR0FBeEMsRUFBNkM7QUFDNUUsTUFBSSx5QkFBT3NCLElBQVAsS0FBZSxRQUFmLElBQTJCLHlCQUFPdEIsR0FBUCxLQUFjLFFBQTdDLEVBQXVEO0FBQ3JELFFBQUl1QixHQUFHLEdBQUdELElBQUksQ0FBQ3ZCLEdBQUwsQ0FBU3lCLEtBQVQsQ0FBZSxHQUFmLENBQVY7O0FBQ0EsU0FBSyxJQUFJTixDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHSyxHQUFHLENBQUNQLE1BQXhCLEVBQWdDRSxDQUFDLEVBQWpDO0FBQ0VLLE1BQUFBLEdBQUcsQ0FBQ0wsQ0FBRCxDQUFILEdBQVMsTUFBTUssR0FBRyxDQUFDTCxDQUFELENBQWxCO0FBREY7O0FBRUEsUUFBSU8sR0FBRyxHQUFHLEVBQVY7O0FBQ0EsU0FBSyxJQUFJUCxDQUFDLEdBQUcsQ0FBYixFQUFnQkEsQ0FBQyxHQUFHSyxHQUFHLENBQUNQLE1BQXhCLEVBQWdDRSxDQUFDLEVBQWpDO0FBQ0VPLE1BQUFBLEdBQUcsQ0FBQ1AsQ0FBRCxDQUFILEdBQVMsSUFBSVEsTUFBSixDQUFXSCxHQUFHLENBQUNMLENBQUQsQ0FBSCxHQUFTLEdBQXBCLENBQVQ7QUFERjs7QUFFQXJCLElBQUFBLGVBQWUsQ0FBQzhCLE9BQU8sQ0FBQ0MsR0FBUixFQUFELEVBQWdCSCxHQUFoQixFQUFxQnpCLEdBQXJCLENBQWY7QUFDRDtBQUNGLENBVkQ7O2VBWWU7QUFDWnFCLEVBQUFBLHdCQUF3QixFQUF4QkE7QUFEWSxDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGZzIGZyb20gJ2ZzJztcblxuZnVuY3Rpb24gZmluZF9leHRlbnNpb25zKGZvbGRlciwgZXh0LCByZXQpIHtcbiAgdHJ5IHtcbiAgICBmcy5hY2Nlc3NTeW5jKGZvbGRlciwgZnMuY29uc3RhbnRzLlJfT0spO1xuICB9IGNhdGNoIChlcnIpIHtcbiAgICByZXR1cm47XG4gIH1cbiAgaWYgKGZzLnN0YXRTeW5jKGZvbGRlcikuaXNEaXJlY3RvcnkoKSAmJiBmb2xkZXIuaW5kZXhPZignbm9kZV9tb2R1bGVzJykgPT0gLTEgJiYgKGZzLnN0YXRTeW5jKGZvbGRlcilbXCJtb2RlXCJdICYgNCkpIHtcbiAgICBmcy5yZWFkZGlyU3luYyhmb2xkZXIpLmZvckVhY2goZmlsZSA9PiB7XG4gICAgICB2YXIgdG1wO1xuICAgICAgaWYgKE51bWJlci5wYXJzZUludChmb2xkZXIubGFzdEluZGV4T2YoJy8nKSArIDEpID09PSBmb2xkZXIubGVuZ3RoKVxuICAgICAgICB0bXAgPSBmb2xkZXIgKyBmaWxlO1xuICAgICAgZWxzZVxuICAgICAgICB0bXAgPSBmb2xkZXIgKyAnLycgKyBmaWxlO1xuICAgICAgaWYgKGZzLnN0YXRTeW5jKHRtcCkuaXNEaXJlY3RvcnkoKSlcbiAgICAgICAgZmluZF9leHRlbnNpb25zKHRtcCwgZXh0LCByZXQpO1xuICAgICAgZWxzZSB7XG4gICAgICAgIHZhciBwID0gdHJ1ZTtcbiAgICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBleHQubGVuZ3RoOyBpKyspXG4gICAgICAgICAgaWYgKGV4dFtpXS50ZXN0KGZpbGUpKVxuICAgICAgICAgICAgcCA9IGZhbHNlO1xuICAgICAgICBpZiAocClcbiAgICAgICAgICByZXQucHVzaChmb2xkZXIgKyAnLycgKyBmaWxlKTtcbiAgICAgIH1cbiAgICB9KTtcbiAgfVxufVxuXG5jb25zdCBtYWtlX2F2YWlsYWJsZV9leHRlbnNpb24gPSBmdW5jdGlvbiBtYWtlX2F2YWlsYWJsZV9leHRlbnNpb24ob3B0cywgcmV0KSB7XG4gIGlmICh0eXBlb2Ygb3B0cyA9PSAnb2JqZWN0JyAmJiB0eXBlb2YgcmV0ID09ICdvYmplY3QnKSB7XG4gICAgdmFyIG1hcyA9IG9wdHMuZXh0LnNwbGl0KCcsJyk7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCBtYXMubGVuZ3RoOyBpKyspXG4gICAgICBtYXNbaV0gPSAnLicgKyBtYXNbaV07XG4gICAgdmFyIHJlcyA9IFtdO1xuICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbWFzLmxlbmd0aDsgaSsrKVxuICAgICAgcmVzW2ldID0gbmV3IFJlZ0V4cChtYXNbaV0gKyAnJCcpO1xuICAgIGZpbmRfZXh0ZW5zaW9ucyhwcm9jZXNzLmN3ZCgpLCByZXMsIHJldCk7XG4gIH1cbn1cblxuZXhwb3J0IGRlZmF1bHQge1xuICAgbWFrZV9hdmFpbGFibGVfZXh0ZW5zaW9uXG59O1xuIl19