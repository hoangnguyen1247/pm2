"use strict";

var _os = _interopRequireDefault(require("os"));

var _path = _interopRequireDefault(require("path"));

var _blessed = _interopRequireDefault(require("blessed"));

var _debug = _interopRequireDefault(require("debug"));

var _sprintfJs = require("sprintf-js");

var _moment = _interopRequireDefault(require("moment"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

/**
 * Copyright 2013 the PM2 project authors. All rights reserved.
 * Use of this source code is governed by a license that
 * can be found in the LICENSE file.
 */
var debug = (0, _debug["default"])('pm2:monit'); // Total memory

var totalMem = _os["default"].totalmem();

var Dashboard = {};
var DEFAULT_PADDING = {
  top: 0,
  left: 1,
  right: 1
};
var WIDTH_LEFT_PANEL = 30;
/**
 * Synchronous Dashboard init method
 * @method init
 * @return this
 */

Dashboard.init = function () {
  var _this = this;

  // Init Screen
  this.screen = _blessed["default"].screen({
    smartCSR: true,
    fullUnicode: true
  });
  this.screen.title = 'PM2 Dashboard';
  this.logLines = {};
  this.list = _blessed["default"].list({
    top: '0',
    left: '0',
    width: WIDTH_LEFT_PANEL + '%',
    height: '70%',
    padding: 0,
    scrollbar: {
      ch: ' ',
      inverse: false
    },
    border: {
      type: 'line'
    },
    keys: true,
    autoCommandKeys: true,
    tags: true,
    style: {
      selected: {
        bg: 'blue',
        fg: 'white'
      },
      scrollbar: {
        bg: 'blue',
        fg: 'black'
      },
      fg: 'white',
      border: {
        fg: 'blue'
      },
      header: {
        fg: 'blue'
      }
    }
  });
  this.list.on('select item', function (item, i) {
    _this.logLines = [];

    _this.logBox.clearItems();
  });
  this.logBox = _blessed["default"].list({
    label: ' Logs ',
    top: '0',
    left: WIDTH_LEFT_PANEL + '%',
    width: 100 - WIDTH_LEFT_PANEL + '%',
    height: '70%',
    padding: DEFAULT_PADDING,
    scrollable: true,
    scrollbar: {
      ch: ' ',
      inverse: false
    },
    keys: true,
    autoCommandKeys: true,
    tags: true,
    border: {
      type: 'line'
    },
    style: {
      fg: 'white',
      border: {
        fg: 'white'
      },
      scrollbar: {
        bg: 'blue',
        fg: 'black'
      }
    }
  });
  this.metadataBox = _blessed["default"].box({
    label: ' Metadata ',
    top: '70%',
    left: WIDTH_LEFT_PANEL + '%',
    width: 100 - WIDTH_LEFT_PANEL + '%',
    height: '26%',
    padding: DEFAULT_PADDING,
    scrollable: true,
    scrollbar: {
      ch: ' ',
      inverse: false
    },
    keys: true,
    autoCommandKeys: true,
    tags: true,
    border: {
      type: 'line'
    },
    style: {
      fg: 'white',
      border: {
        fg: 'white'
      },
      scrollbar: {
        bg: 'blue',
        fg: 'black'
      }
    }
  });
  this.metricsBox = _blessed["default"].list({
    label: ' Custom Metrics ',
    top: '70%',
    left: '0%',
    width: WIDTH_LEFT_PANEL + '%',
    height: '26%',
    padding: DEFAULT_PADDING,
    scrollbar: {
      ch: ' ',
      inverse: false
    },
    keys: true,
    autoCommandKeys: true,
    tags: true,
    border: {
      type: 'line'
    },
    style: {
      fg: 'white',
      border: {
        fg: 'white'
      },
      scrollbar: {
        bg: 'blue',
        fg: 'black'
      }
    }
  });
  this.box4 = _blessed["default"].text({
    content: ' left/right: switch boards | up/down/mouse: scroll | Ctrl-C: exit{|} {cyan-fg}{bold}To go further check out https://pm2.io/{/}  ',
    left: '0%',
    top: '95%',
    width: '100%',
    height: '6%',
    valign: 'middle',
    tags: true,
    style: {
      fg: 'white'
    }
  });
  this.list.focus();
  this.screen.append(this.list);
  this.screen.append(this.logBox);
  this.screen.append(this.metadataBox);
  this.screen.append(this.metricsBox);
  this.screen.append(this.box4);
  this.list.setLabel(' Process List ');
  this.screen.render();
  var that = this;
  var i = 0;
  var boards = ['list', 'logBox', 'metricsBox', 'metadataBox'];
  this.screen.key(['left', 'right'], function (ch, key) {
    key.name === 'left' ? i-- : i++;
    if (i == 4) i = 0;
    if (i == -1) i = 3;
    that[boards[i]].focus();
    that[boards[i]].style.border.fg = 'blue';

    if (key.name === 'left') {
      if (i == 3) that[boards[0]].style.border.fg = 'white';else that[boards[i + 1]].style.border.fg = 'white';
    } else {
      if (i == 0) that[boards[3]].style.border.fg = 'white';else that[boards[i - 1]].style.border.fg = 'white';
    }
  });
  this.screen.key(['escape', 'q', 'C-c'], function (ch, key) {
    this.screen.destroy();
    process.exit(0);
  }); // async refresh of the ui

  setInterval(function () {
    that.screen.render();
  }, 300);
  return this;
};
/**
 * Refresh dashboard
 * @method refresh
 * @param {} processes
 * @return this
 */


Dashboard.refresh = function (processes) {
  debug('Monit refresh');

  if (!processes) {
    this.list.setItem(0, 'No process available');
    return;
  }

  if (processes.length != this.list.items.length) {
    this.list.clearItems();
  } // Total of processes memory


  var mem = 0;
  processes.forEach(function (proc) {
    mem += proc.monit.memory;
  }); // Sort process list

  processes.sort(function (a, b) {
    if (a.pm2_env.name < b.pm2_env.name) return -1;
    if (a.pm2_env.name > b.pm2_env.name) return 1;
    return 0;
  }); // Loop to get process infos

  for (var i = 0; i < processes.length; i++) {
    // Percent of memory use by one process in all pm2 processes
    var memPercent = processes[i].monit.memory / mem * 100; // Status of process

    var status = processes[i].pm2_env.status == 'online' ? '{green-fg}' : '{red-fg}';
    status = status + '{bold}' + processes[i].pm2_env.status + '{/}';

    var name = processes[i].pm2_env.name || _path["default"].basename(processes[i].pm2_env.pm_exec_path); // Line of list


    var item = (0, _sprintfJs.sprintf)('[%2s] %s {|} Mem: {bold}{%s-fg}%3d{/} MB    CPU: {bold}{%s-fg}%2d{/} %s  %s', processes[i].pm2_env.pm_id, name, gradient(memPercent, [255, 0, 0], [0, 255, 0]), (processes[i].monit.memory / 1048576).toFixed(2), gradient(processes[i].monit.cpu, [255, 0, 0], [0, 255, 0]), processes[i].monit.cpu, "%", status); // Check if item exist

    if (this.list.getItem(i)) {
      this.list.setItem(i, item);
    } else {
      this.list.pushItem(item);
    }

    var proc = processes[this.list.selected]; // render the logBox

    var process_id = proc.pm_id;
    var logs = this.logLines[process_id];

    if (typeof logs !== "undefined") {
      this.logBox.setItems(logs);

      if (!this.logBox.focused) {
        this.logBox.setScrollPerc(100);
      }
    } else {
      this.logBox.clearItems();
    }

    this.logBox.setLabel("  ".concat(proc.pm2_env.name, " Logs  "));
    this.metadataBox.setLine(0, 'App Name              ' + '{bold}' + proc.pm2_env.name + '{/}');
    this.metadataBox.setLine(1, 'Namespace             ' + '{bold}' + proc.pm2_env.namespace + '{/}');
    this.metadataBox.setLine(2, 'Version               ' + '{bold}' + proc.pm2_env.version + '{/}');
    this.metadataBox.setLine(3, 'Restarts              ' + proc.pm2_env.restart_time);
    this.metadataBox.setLine(4, 'Uptime                ' + (proc.pm2_env.pm_uptime && proc.pm2_env.status == 'online' ? timeSince(proc.pm2_env.pm_uptime) : 0));
    this.metadataBox.setLine(5, 'Script path           ' + proc.pm2_env.pm_exec_path);
    this.metadataBox.setLine(6, 'Script args           ' + (proc.pm2_env.args ? (typeof proc.pm2_env.args == 'string' ? JSON.parse(proc.pm2_env.args.replace(/'/g, '"')) : proc.pm2_env.args).join(' ') : 'N/A'));
    this.metadataBox.setLine(7, 'Interpreter           ' + proc.pm2_env.exec_interpreter);
    this.metadataBox.setLine(8, 'Interpreter args      ' + (proc.pm2_env.node_args.length != 0 ? proc.pm2_env.node_args : 'N/A'));
    this.metadataBox.setLine(9, 'Exec mode             ' + (proc.pm2_env.exec_mode == 'fork_mode' ? '{bold}fork{/}' : '{blue-fg}{bold}cluster{/}'));
    this.metadataBox.setLine(10, 'Node.js version       ' + proc.pm2_env.node_version);
    this.metadataBox.setLine(11, 'watch & reload        ' + (proc.pm2_env.watch ? '{green-fg}{bold}✔{/}' : '{red-fg}{bold}✘{/}'));
    this.metadataBox.setLine(12, 'Unstable restarts     ' + proc.pm2_env.unstable_restarts);
    this.metadataBox.setLine(13, 'Comment               ' + (proc.pm2_env.versioning ? proc.pm2_env.versioning.comment : 'N/A'));
    this.metadataBox.setLine(14, 'Revision              ' + (proc.pm2_env.versioning ? proc.pm2_env.versioning.revision : 'N/A'));
    this.metadataBox.setLine(15, 'Branch                ' + (proc.pm2_env.versioning ? proc.pm2_env.versioning.branch : 'N/A'));
    this.metadataBox.setLine(16, 'Remote url            ' + (proc.pm2_env.versioning ? proc.pm2_env.versioning.url : 'N/A'));
    this.metadataBox.deleteLine(17);
    this.metadataBox.setLine(17, 'Last update           ' + (proc.pm2_env.versioning ? proc.pm2_env.versioning.update_time : 'N/A'));

    if (Object.keys(proc.pm2_env.axm_monitor).length != this.metricsBox.items.length) {
      this.metricsBox.clearItems();
    }

    var j = 0;

    for (var key in proc.pm2_env.axm_monitor) {
      var metric_name = proc.pm2_env.axm_monitor[key].hasOwnProperty('value') ? proc.pm2_env.axm_monitor[key].value : proc.pm2_env.axm_monitor[key];
      var metric_unit = proc.pm2_env.axm_monitor[key].hasOwnProperty('unit') ? proc.pm2_env.axm_monitor[key].unit : null;
      var probe = "{bold}".concat(key, "{/} {|} ").concat(metric_name).concat(metric_unit == null ? '' : ' ' + metric_unit);

      if (this.metricsBox.getItem(j)) {
        this.metricsBox.setItem(j, probe);
      } else {
        this.metricsBox.pushItem(probe);
      }

      j++;
    }

    this.screen.render();
  }

  return this;
};
/**
 * Put Log
 * @method log
 * @param {} data
 * @return this
 */


Dashboard.log = function (type, data) {
  var _this2 = this;

  var that = this;

  if (typeof this.logLines[data.process.pm_id] == "undefined") {
    this.logLines[data.process.pm_id] = [];
  } // Logs colors


  switch (type) {
    case 'PM2':
      var color = '{blue-fg}';
      break;

    case 'out':
      var color = '{green-fg}';
      break;

    case 'err':
      var color = '{red-fg}';
      break;

    default:
      var color = '{white-fg}';
  }

  var logs = data.data.split('\n');
  logs.forEach(function (log) {
    if (log.length > 0) {
      _this2.logLines[data.process.pm_id].push(color + data.process.name + '{/} > ' + log); //removing logs if longer than limit


      var count = 0;
      var max_count = 0;
      var leading_process_id = -1;

      for (var process_id in _this2.logLines) {
        count += _this2.logLines[process_id].length;

        if (_this2.logLines[process_id].length > max_count) {
          leading_process_id = +process_id;
          max_count = _this2.logLines[process_id].length;
        }
      }

      if (count > 200) {
        _this2.logLines[leading_process_id].shift();
      }
    }
  });
  return this;
};

module.exports = Dashboard;

function timeSince(date) {
  var seconds = Math.floor((0, _moment["default"])().unix() - (0, _moment["default"])(date).unix());
  var interval = Math.floor(seconds / 31536000);

  if (interval > 1) {
    return interval + 'Y';
  }

  interval = Math.floor(seconds / 2592000);

  if (interval > 1) {
    return interval + 'M';
  }

  interval = Math.floor(seconds / 86400);

  if (interval > 1) {
    return interval + 'D';
  }

  interval = Math.floor(seconds / 3600);

  if (interval > 1) {
    return interval + 'h';
  }

  interval = Math.floor(seconds / 60);

  if (interval > 1) {
    return interval + 'm';
  }

  return Math.floor(seconds) + 's';
}
/* Args :
 *  p : Percent 0 - 100
 *  rgb_ : Array of rgb [255, 255, 255]
 * Return :
 *  Hexa #FFFFFF
 */


function gradient(p, rgb_beginning, rgb_end) {
  var w = p / 100 * 2 - 1;
  var w1 = (w + 1) / 2.0;
  var w2 = 1 - w1;
  var rgb = [parseInt(rgb_beginning[0] * w1 + rgb_end[0] * w2 + ""), parseInt(rgb_beginning[1] * w1 + rgb_end[1] * w2 + ""), parseInt(rgb_beginning[2] * w1 + rgb_end[2] * w2 + "")];
  return "#" + ((1 << 24) + (rgb[0] << 16) + (rgb[1] << 8) + rgb[2]).toString(16).slice(1);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9BUEkvRGFzaGJvYXJkLnRzIl0sIm5hbWVzIjpbImRlYnVnIiwidG90YWxNZW0iLCJvcyIsInRvdGFsbWVtIiwiRGFzaGJvYXJkIiwiREVGQVVMVF9QQURESU5HIiwidG9wIiwibGVmdCIsInJpZ2h0IiwiV0lEVEhfTEVGVF9QQU5FTCIsImluaXQiLCJzY3JlZW4iLCJibGVzc2VkIiwic21hcnRDU1IiLCJmdWxsVW5pY29kZSIsInRpdGxlIiwibG9nTGluZXMiLCJsaXN0Iiwid2lkdGgiLCJoZWlnaHQiLCJwYWRkaW5nIiwic2Nyb2xsYmFyIiwiY2giLCJpbnZlcnNlIiwiYm9yZGVyIiwidHlwZSIsImtleXMiLCJhdXRvQ29tbWFuZEtleXMiLCJ0YWdzIiwic3R5bGUiLCJzZWxlY3RlZCIsImJnIiwiZmciLCJoZWFkZXIiLCJvbiIsIml0ZW0iLCJpIiwibG9nQm94IiwiY2xlYXJJdGVtcyIsImxhYmVsIiwic2Nyb2xsYWJsZSIsIm1ldGFkYXRhQm94IiwiYm94IiwibWV0cmljc0JveCIsImJveDQiLCJ0ZXh0IiwiY29udGVudCIsInZhbGlnbiIsImZvY3VzIiwiYXBwZW5kIiwic2V0TGFiZWwiLCJyZW5kZXIiLCJ0aGF0IiwiYm9hcmRzIiwia2V5IiwibmFtZSIsImRlc3Ryb3kiLCJwcm9jZXNzIiwiZXhpdCIsInNldEludGVydmFsIiwicmVmcmVzaCIsInByb2Nlc3NlcyIsInNldEl0ZW0iLCJsZW5ndGgiLCJpdGVtcyIsIm1lbSIsImZvckVhY2giLCJwcm9jIiwibW9uaXQiLCJtZW1vcnkiLCJzb3J0IiwiYSIsImIiLCJwbTJfZW52IiwibWVtUGVyY2VudCIsInN0YXR1cyIsInAiLCJiYXNlbmFtZSIsInBtX2V4ZWNfcGF0aCIsInBtX2lkIiwiZ3JhZGllbnQiLCJ0b0ZpeGVkIiwiY3B1IiwiZ2V0SXRlbSIsInB1c2hJdGVtIiwicHJvY2Vzc19pZCIsImxvZ3MiLCJzZXRJdGVtcyIsImZvY3VzZWQiLCJzZXRTY3JvbGxQZXJjIiwic2V0TGluZSIsIm5hbWVzcGFjZSIsInZlcnNpb24iLCJyZXN0YXJ0X3RpbWUiLCJwbV91cHRpbWUiLCJ0aW1lU2luY2UiLCJhcmdzIiwiSlNPTiIsInBhcnNlIiwicmVwbGFjZSIsImpvaW4iLCJleGVjX2ludGVycHJldGVyIiwibm9kZV9hcmdzIiwiZXhlY19tb2RlIiwibm9kZV92ZXJzaW9uIiwid2F0Y2giLCJ1bnN0YWJsZV9yZXN0YXJ0cyIsInZlcnNpb25pbmciLCJjb21tZW50IiwicmV2aXNpb24iLCJicmFuY2giLCJ1cmwiLCJkZWxldGVMaW5lIiwidXBkYXRlX3RpbWUiLCJPYmplY3QiLCJheG1fbW9uaXRvciIsImoiLCJtZXRyaWNfbmFtZSIsImhhc093blByb3BlcnR5IiwidmFsdWUiLCJtZXRyaWNfdW5pdCIsInVuaXQiLCJwcm9iZSIsImxvZyIsImRhdGEiLCJjb2xvciIsInNwbGl0IiwicHVzaCIsImNvdW50IiwibWF4X2NvdW50IiwibGVhZGluZ19wcm9jZXNzX2lkIiwic2hpZnQiLCJtb2R1bGUiLCJleHBvcnRzIiwiZGF0ZSIsInNlY29uZHMiLCJNYXRoIiwiZmxvb3IiLCJ1bml4IiwiaW50ZXJ2YWwiLCJyZ2JfYmVnaW5uaW5nIiwicmdiX2VuZCIsInciLCJ3MSIsIncyIiwicmdiIiwicGFyc2VJbnQiLCJ0b1N0cmluZyIsInNsaWNlIl0sIm1hcHBpbmdzIjoiOztBQU1BOztBQUNBOztBQUNBOztBQUNBOztBQUNBOztBQUNBOzs7O0FBWEE7Ozs7O0FBYUEsSUFBTUEsS0FBSyxHQUFHLHVCQUFZLFdBQVosQ0FBZCxDLENBQ0E7O0FBQ0EsSUFBTUMsUUFBUSxHQUFHQyxlQUFHQyxRQUFILEVBQWpCOztBQUVBLElBQUlDLFNBQWMsR0FBRyxFQUFyQjtBQUVBLElBQUlDLGVBQWUsR0FBRztBQUNwQkMsRUFBQUEsR0FBRyxFQUFHLENBRGM7QUFFcEJDLEVBQUFBLElBQUksRUFBRyxDQUZhO0FBR3BCQyxFQUFBQSxLQUFLLEVBQUc7QUFIWSxDQUF0QjtBQU1BLElBQUlDLGdCQUFnQixHQUFH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Z2h0IDIwMTMgdGhlIFBNMiBwcm9qZWN0IGF1dGhvcnMuIEFsbCByaWdodHMgcmVzZXJ2ZWQuXG4gKiBVc2Ugb2YgdGhpcyBzb3VyY2UgY29kZSBpcyBnb3Zlcm5lZCBieSBhIGxpY2Vuc2UgdGhhdFxuICogY2FuIGJlIGZvdW5kIGluIHRoZSBMSUNFTlNFIGZpbGUuXG4gKi9cblxuaW1wb3J0IG9zICAgICAgICAgZnJvbSAnb3MnO1xuaW1wb3J0IHAgICAgICAgICAgZnJvbSAncGF0aCc7XG5pbXBvcnQgYmxlc3NlZCAgICBmcm9tICdibGVzc2VkJztcbmltcG9ydCBkZWJ1Z0xvZ2dlciAgICAgIGZyb20gJ2RlYnVnJztcbmltcG9ydCB7IHNwcmludGYgfSAgIGZyb20gJ3NwcmludGYtanMnO1xuaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnO1xuXG5jb25zdCBkZWJ1ZyA9IGRlYnVnTG9nZ2VyKCdwbTI6bW9uaXQnKTtcbi8vIFRvdGFsIG1lbW9yeVxuY29uc3QgdG90YWxNZW0gPSBvcy50b3RhbG1lbSgpO1xuXG52YXIgRGFzaGJvYXJkOiBhbnkgPSB7fTtcblxudmFyIERFRkFVTFRfUEFERElORyA9IHtcbiAgdG9wIDogMCxcbiAgbGVmdCA6IDEsXG4gIHJpZ2h0IDogMVxufTtcblxudmFyIFdJRFRIX0xFRlRfUEFORUwgPSAzMDtcblxuLyoqXG4gKiBTeW5jaHJvbm91cyBEYXNoYm9hcmQgaW5pdCBtZXRob2RcbiAqIEBtZXRob2QgaW5pdFxuICogQHJldHVybiB0aGlzXG4gKi9cbkRhc2hib2FyZC5pbml0ID0gZnVuY3Rpb24oKSB7XG4gIC8vIEluaXQgU2NyZWVuXG4gIHRoaXMuc2NyZWVuID0gYmxlc3NlZC5zY3JlZW4oe1xuICAgIHNtYXJ0Q1NSOiB0cnVlLFxuICAgIGZ1bGxVbmljb2RlOiB0cnVlXG4gIH0pO1xuICB0aGlzLnNjcmVlbi50aXRsZSA9ICdQTTIgRGFzaGJvYXJkJztcblxuICB0aGlzLmxvZ0xpbmVzID0ge31cblxuICB0aGlzLmxpc3QgPSBibGVzc2VkLmxpc3Qoe1xuICAgIHRvcDogJzAnLFxuICAgIGxlZnQ6ICcwJyxcbiAgICB3aWR0aDogV0lEVEhfTEVGVF9QQU5FTCArICclJyxcbiAgICBoZWlnaHQ6ICc3MCUnLFxuICAgIHBhZGRpbmc6IDAsXG4gICAgc2Nyb2xsYmFyOiB7XG4gICAgICBjaDogJyAnLFxuICAgICAgaW52ZXJzZTogZmFsc2VcbiAgICB9LFxuICAgIGJvcmRlcjoge1xuICAgICAgdHlwZTogJ2xpbmUnXG4gICAgfSxcbiAgICBrZXlzOiB0cnVlLFxuICAgIGF1dG9Db21tYW5kS2V5czogdHJ1ZSxcbiAgICB0YWdzOiB0cnVlLFxuICAgIHN0eWxlOiB7XG4gICAgICBzZWxlY3RlZDoge1xuICAgICAgICBiZzogJ2JsdWUnLFxuICAgICAgICBmZzogJ3doaXRlJ1xuICAgICAgfSxcbiAgICAgIHNjcm9sbGJhcjoge1xuICAgICAgICBiZzogJ2JsdWUnLFxuICAgICAgICBmZzogJ2JsYWNrJ1xuICAgICAgfSxcbiAgICAgIGZnOiAnd2hpdGUnLFxuICAgICAgYm9yZGVyOiB7XG4gICAgICAgIGZnOiAnYmx1ZSdcbiAgICAgIH0sXG4gICAgICBoZWFkZXI6IHtcbiAgICAgICAgZmc6ICdibHVlJ1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgdGhpcy5saXN0Lm9uKCdzZWxlY3QgaXRlbScsIChpdGVtLCBpKSA9PiB7XG4gICAgdGhpcy5sb2dMaW5lcyA9IFtdXG4gICAgdGhpcy5sb2dCb3guY2xlYXJJdGVtcygpXG4gIH0pXG5cbiAgdGhpcy5sb2dCb3ggPSBibGVzc2VkLmxpc3Qoe1xuICAgIGxhYmVsOiAnIExvZ3MgJyxcbiAgICB0b3A6ICcwJyxcbiAgICBsZWZ0OiBXSURUSF9MRUZUX1BBTkVMICsgJyUnLFxuICAgIHdpZHRoOiAxMDAgLSBXSURUSF9MRUZUX1BBTkVMICsgJyUnLFxuICAgIGhlaWdodDogJzcwJScsXG4gICAgcGFkZGluZzogREVGQVVMVF9QQURESU5HLFxuICAgIHNjcm9sbGFibGU6IHRydWUsXG4gICAgc2Nyb2xsYmFyOiB7XG4gICAgICBjaDogJyAnLFxuICAgICAgaW52ZXJzZTogZmFsc2VcbiAgICB9LFxuICAgIGtleXM6IHRydWUsXG4gICAgYXV0b0NvbW1hbmRLZXlzOiB0cnVlLFxuICAgIHRhZ3M6IHRydWUsXG4gICAgYm9yZGVyOiB7XG4gICAgICB0eXBlOiAnbGluZSdcbiAgICB9LFxuICAgIHN0eWxlOiB7XG4gICAgICBmZzogJ3doaXRlJyxcbiAgICAgIGJvcmRlcjoge1xuICAgICAgICBmZzogJ3doaXRlJ1xuICAgICAgfSxcbiAgICAgIHNjcm9sbGJhcjoge1xuICAgICAgICBiZzogJ2JsdWUnLFxuICAgICAgICBmZzogJ2JsYWNrJ1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgdGhpcy5tZXRhZGF0YUJveCA9IGJsZXNzZWQuYm94KHtcbiAgICBsYWJlbDogJyBNZXRhZGF0YSAnLFxuICAgIHRvcDogJzcwJScsXG4gICAgbGVmdDogV0lEVEhfTEVGVF9QQU5FTCArICclJyxcbiAgICB3aWR0aDogMTAwIC0gV0lEVEhfTEVGVF9QQU5FTCArICclJyxcbiAgICBoZWlnaHQ6ICcyNiUnLFxuICAgIHBhZGRpbmc6IERFRkFVTFRfUEFERElORyxcbiAgICBzY3JvbGxhYmxlOiB0cnVlLFxuICAgIHNjcm9sbGJhcjoge1xuICAgICAgY2g6ICcgJyxcbiAgICAgIGludmVyc2U6IGZhbHNlXG4gICAgfSxcbiAgICBrZXlzOiB0cnVlLFxuICAgIGF1dG9Db21tYW5kS2V5czogdHJ1ZSxcbiAgICB0YWdzOiB0cnVlLFxuICAgIGJvcmRlcjoge1xuICAgICAgdHlwZTogJ2xpbmUnXG4gICAgfSxcbiAgICBzdHlsZToge1xuICAgICAgZmc6ICd3aGl0ZScsXG4gICAgICBib3JkZXI6IHtcbiAgICAgICAgZmc6ICd3aGl0ZSdcbiAgICAgIH0sXG4gICAgICBzY3JvbGxiYXI6IHtcbiAgICAgICAgYmc6ICdibHVlJyxcbiAgICAgICAgZmc6ICdibGFjaydcbiAgICAgIH1cbiAgICB9XG4gIH0pO1xuXG4gIHRoaXMubWV0cmljc0JveCA9IGJsZXNzZWQubGlzdCh7XG4gICAgbGFiZWw6ICcgQ3VzdG9tIE1ldHJpY3MgJyxcbiAgICB0b3A6ICc3MCUnLFxuICAgIGxlZnQ6ICcwJScsXG4gICAgd2lkdGg6IFdJRFRIX0xFRlRfUEFORUwgKyAnJScsXG4gICAgaGVpZ2h0OiAnMjYlJyxcbiAgICBwYWRkaW5nOiBERUZBVUxUX1BBRERJTkcsXG4gICAgc2Nyb2xsYmFyOiB7XG4gICAgICBjaDogJyAnLFxuICAgICAgaW52ZXJzZTogZmFsc2VcbiAgICB9LFxuICAgIGtleXM6IHRydWUsXG4gICAgYXV0b0NvbW1hbmRLZXlzOiB0cnVlLFxuICAgIHRhZ3M6IHRydWUsXG4gICAgYm9yZGVyOiB7XG4gICAgICB0eXBlOiAnbGluZSdcbiAgICB9LFxuICAgIHN0eWxlOiB7XG4gICAgICBmZzogJ3doaXRlJyxcbiAgICAgIGJvcmRlcjoge1xuICAgICAgICBmZzogJ3doaXRlJ1xuICAgICAgfSxcbiAgICAgIHNjcm9sbGJhcjoge1xuICAgICAgICBiZzogJ2JsdWUnLFxuICAgICAgICBmZzogJ2JsYWNrJ1xuICAgICAgfVxuICAgIH1cbiAgfSk7XG5cbiAgdGhpcy5ib3g0ID0gYmxlc3NlZC50ZXh0KHtcbiAgICBjb250ZW50OiAnIGxlZnQvcmlnaHQ6IHN3aXRjaCBib2FyZHMgfCB1cC9kb3duL21vdXNlOiBzY3JvbGwgfCBDdHJsLUM6IGV4aXR7fH0ge2N5YW4tZmd9e2JvbGR9VG8gZ28gZnVydGhlciBjaGVjayBvdXQgaHR0cHM6Ly9wbTIuaW8vey99ICAnLFxuICAgIGxlZnQ6ICcwJScsXG4gICAgdG9wOiAnOTUlJyxcbiAgICB3aWR0aDogJzEwMCUnLFxuICAgIGhlaWdodDogJzYlJyxcbiAgICB2YWxpZ246ICdtaWRkbGUnLFxuICAgIHRhZ3M6IHRydWUsXG4gICAgc3R5bGU6IHtcbiAgICAgIGZnOiAnd2hpdGUnXG4gICAgfVxuICB9KTtcblxuICB0aGlzLmxpc3QuZm9jdXMoKTtcblxuICB0aGlzLnNjcmVlbi5hcHBlbmQodGhpcy5saXN0KTtcbiAgdGhpcy5zY3JlZW4uYXBwZW5kKHRoaXMubG9nQm94KTtcbiAgdGhpcy5zY3JlZW4uYXBwZW5kKHRoaXMubWV0YWRhdGFCb3gpO1xuICB0aGlzLnNjcmVlbi5hcHBlbmQodGhpcy5tZXRyaWNzQm94KTtcbiAgdGhpcy5zY3JlZW4uYXBwZW5kKHRoaXMuYm94NCk7XG5cbiAgdGhpcy5saXN0LnNldExhYmVsKCcgUHJvY2VzcyBMaXN0ICcpO1xuXG4gIHRoaXMuc2NyZWVuLnJlbmRlcigpO1xuXG4gIHZhciB0aGF0ID0gdGhpcztcblxuICB2YXIgaSA9IDA7XG4gIHZhciBib2FyZHMgPSBbJ2xpc3QnLCAnbG9nQm94JywgJ21ldHJpY3NCb3gnLCAnbWV0YWRhdGFCb3gnXTtcbiAgdGhpcy5zY3JlZW4ua2V5KFsnbGVmdCcsICdyaWdodCddLCBmdW5jdGlvbihjaCwga2V5KSB7XG4gICAgKGtleS5uYW1lID09PSAnbGVmdCcpID8gaS0tIDogaSsrO1xuICAgIGlmIChpID09IDQpXG4gICAgICBpID0gMDtcbiAgICBpZiAoaSA9PSAtMSlcbiAgICAgIGkgPSAzO1xuICAgIHRoYXRbYm9hcmRzW2ldXS5mb2N1cygpO1xuICAgIHRoYXRbYm9hcmRzW2ldXS5zdHlsZS5ib3JkZXIuZmcgPSAnYmx1ZSc7XG4gICAgaWYgKGtleS5uYW1lID09PSAnbGVmdCcpIHtcbiAgICAgIGlmIChpID09IDMpXG4gICAgICAgIHRoYXRbYm9hcmRzWzBdXS5zdHlsZS5ib3JkZXIuZmcgPSAnd2hpdGUnO1xuICAgICAgZWxzZVxuICAgICAgICB0aGF0W2JvYXJkc1tpICsgMV1dLnN0eWxlLmJvcmRlci5mZyA9ICd3aGl0ZSc7XG4gICAgfVxuICAgIGVsc2Uge1xuICAgICAgIGlmIChpID09IDApXG4gICAgICAgIHRoYXRbYm9hcmRzWzNdXS5zdHlsZS5ib3JkZXIuZmcgPSAnd2hpdGUnO1xuICAgICAgZWxzZVxuICAgICAgICB0aGF0W2JvYXJkc1tpIC0gMV1dLnN0eWxlLmJvcmRlci5mZyA9ICd3aGl0ZSc7XG4gICAgfVxuICB9KTtcblxuICB0aGlzLnNjcmVlbi5rZXkoWydlc2NhcGUnLCAncScsICdDLWMnXSwgZnVuY3Rpb24oY2gsIGtleSkge1xuICAgIHRoaXMuc2NyZWVuLmRlc3Ryb3koKTtcbiAgICBwcm9jZXNzLmV4aXQoMCk7XG4gIH0pO1xuXG4gIC8vIGFzeW5jIHJlZnJlc2ggb2YgdGhlIHVpXG4gIHNldEludGVydmFsKGZ1bmN0aW9uICgpIHtcbiAgICB0aGF0LnNjcmVlbi5yZW5kZXIoKTtcbiAgfSwgMzAwKTtcblxuICByZXR1cm4gdGhpcztcbn1cblxuLyoqXG4gKiBSZWZyZXNoIGRhc2hib2FyZFxuICogQG1ldGhvZCByZWZyZXNoXG4gKiBAcGFyYW0ge30gcHJvY2Vzc2VzXG4gKiBAcmV0dXJuIHRoaXNcbiAqL1xuRGFzaGJvYXJkLnJlZnJlc2ggPSBmdW5jdGlvbihwcm9jZXNzZXMpIHtcbiAgZGVidWcoJ01vbml0IHJlZnJlc2gnKTtcblxuICBpZighcHJvY2Vzc2VzKSB7XG4gICAgdGhpcy5saXN0LnNldEl0ZW0oMCwgJ05vIHByb2Nlc3MgYXZhaWxhYmxlJyk7XG4gICAgcmV0dXJuO1xuICB9XG5cbiAgaWYgKHByb2Nlc3Nlcy5sZW5ndGggIT0gdGhpcy5saXN0Lml0ZW1zLmxlbmd0aCkge1xuICAgIHRoaXMubGlzdC5jbGVhckl0ZW1zKCk7XG4gIH1cblxuICAvLyBUb3RhbCBvZiBwcm9jZXNzZXMgbWVtb3J5XG4gIHZhciBtZW0gPSAwO1xuICBwcm9jZXNzZXMuZm9yRWFjaChmdW5jdGlvbihwcm9jKSB7XG4gICAgbWVtICs9IHByb2MubW9uaXQubWVtb3J5O1xuICB9KVxuXG4gIC8vIFNvcnQgcHJvY2VzcyBsaXN0XG4gIHByb2Nlc3Nlcy5zb3J0KGZ1bmN0aW9uKGEsIGIpIHtcbiAgICBpZiAoYS5wbTJfZW52Lm5hbWUgPCBiLnBtMl9lbnYubmFtZSlcbiAgICAgIHJldHVybiAtMTtcbiAgICBpZiAoYS5wbTJfZW52Lm5hbWUgPiBiLnBtMl9lbnYubmFtZSlcbiAgICAgIHJldHVybiAxO1xuICAgIHJldHVybiAwO1xuICB9KTtcblxuICAvLyBMb29wIHRvIGdldCBwcm9jZXNzIGluZm9zXG4gIGZvciAodmFyIGkgPSAwOyBpIDwgcHJvY2Vzc2VzLmxlbmd0aDsgaSsrKSB7XG4gICAgLy8gUGVyY2VudCBvZiBtZW1vcnkgdXNlIGJ5IG9uZSBwcm9jZXNzIGluIGFsbCBwbTIgcHJvY2Vzc2VzXG4gICAgdmFyIG1lbVBlcmNlbnQgPSAocHJvY2Vzc2VzW2ldLm1vbml0Lm1lbW9yeSAvIG1lbSkgKiAxMDA7XG5cbiAgICAvLyBTdGF0dXMgb2YgcHJvY2Vzc1xuICAgIHZhciBzdGF0dXMgPSBwcm9jZXNzZXNbaV0ucG0yX2Vudi5zdGF0dXMgPT0gJ29ubGluZScgPyAne2dyZWVuLWZnfScgOiAne3JlZC1mZ30nO1xuICAgIHN0YXR1cyA9IHN0YXR1cyArICd7Ym9sZH0nICsgcHJvY2Vzc2VzW2ldLnBtMl9lbnYuc3RhdHVzICsgJ3svfSc7XG5cbiAgICB2YXIgbmFtZSA9IHByb2Nlc3Nlc1tpXS5wbTJfZW52Lm5hbWUgfHwgcC5iYXNlbmFtZShwcm9jZXNzZXNbaV0ucG0yX2Vudi5wbV9leGVjX3BhdGgpO1xuXG4gICAgLy8gTGluZSBvZiBsaXN0XG4gICAgdmFyIGl0ZW0gPSBzcHJpbnRmKCdbJTJzXSAlcyB7fH0gTWVtOiB7Ym9sZH17JXMtZmd9JTNkey99IE1CICAgIENQVToge2JvbGR9eyVzLWZnfSUyZHsvfSAlcyAgJXMnLFxuICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzZXNbaV0ucG0yX2Vudi5wbV9pZCxcbiAgICAgICAgICAgICAgICAgICAgICAgbmFtZSxcbiAgICAgICAgICAgICAgICAgICAgICAgZ3JhZGllbnQobWVtUGVyY2VudCwgWzI1NSwgMCwgMF0sIFswLCAyNTUsIDBdKSxcbiAgICAgICAgICAgICAgICAgICAgICAgKHByb2Nlc3Nlc1tpXS5tb25pdC5tZW1vcnkgLyAxMDQ4NTc2KS50b0ZpeGVkKDIpLFxuICAgICAgICAgICAgICAgICAgICAgICBncmFkaWVudChwcm9jZXNzZXNbaV0ubW9uaXQuY3B1LCBbMjU1LCAwLCAwXSwgWzAsIDI1NSwgMF0pLFxuICAgICAgICAgICAgICAgICAgICAgICBwcm9jZXNzZXNbaV0ubW9uaXQuY3B1LFxuICAgICAgICAgICAgICAgICAgICAgICBcIiVcIixcbiAgICAgICAgICAgICAgICAgICAgICAgc3RhdHVzKTtcblxuICAgIC8vIENoZWNrIGlmIGl0ZW0gZXhpc3RcbiAgICBpZiAodGhpcy5saXN0LmdldEl0ZW0oaSkpIHtcbiAgICAgIHRoaXMubGlzdC5zZXRJdGVtKGksIGl0ZW0pO1xuICAgIH1cbiAgICBlbHNlIHtcbiAgICAgIHRoaXMubGlzdC5wdXNoSXRlbShpdGVtKTtcbiAgICB9XG5cbiAgICB2YXIgcHJvYyA9IHByb2Nlc3Nlc1t0aGlzLmxpc3Quc2VsZWN0ZWRdO1xuICAgIC8vIHJlbmRlciB0aGUgbG9nQm94XG4gICAgbGV0IHByb2Nlc3NfaWQgPSBwcm9jLnBtX2lkXG4gICAgbGV0IGxvZ3MgPSB0aGlzLmxvZ0xpbmVzW3Byb2Nlc3NfaWRdO1xuICAgIGlmKHR5cGVvZihsb2dzKSAhPT0gXCJ1bmRlZmluZWRcIil7XG4gICAgICB0aGlzLmxvZ0JveC5zZXRJdGVtcyhsb2dzKVxuICAgICAgaWYgKCF0aGlzLmxvZ0JveC5mb2N1c2VkKSB7XG4gICAgICAgICAgdGhpcy5sb2dCb3guc2V0U2Nyb2xsUGVyYygxMDApO1xuICAgICAgfVxuICAgIH1lbHNle1xuICAgICAgdGhpcy5sb2dCb3guY2xlYXJJdGVtcygpO1xuICAgIH1cbiAgICB0aGlzLmxvZ0JveC5zZXRMYWJlbChgICAke3Byb2MucG0yX2Vudi5uYW1lfSBMb2dzICBgKVxuXG4gICAgdGhpcy5tZXRhZGF0YUJveC5zZXRMaW5lKDAsICdBcHAgTmFtZSAgICAgICAgICAgICAgJyArICd7Ym9sZH0nICsgcHJvYy5wbTJfZW52Lm5hbWUgKyAney99Jyk7XG4gICAgdGhpcy5tZXRhZGF0YUJveC5zZXRMaW5lKDEsICdOYW1lc3BhY2UgICAgICAgICAgICAgJyArICd7Ym9sZH0nICsgcHJvYy5wbTJfZW52Lm5hbWVzcGFjZSArICd7L30nKTtcbiAgICB0aGlzLm1ldGFkYXRhQm94LnNldExpbmUoMiwgJ1ZlcnNpb24gICAgICAgICAgICAgICAnICsgJ3tib2xkfScgKyBwcm9jLnBtMl9lbnYudmVyc2lvbiArICd7L30nKTtcbiAgICB0aGlzLm1ldGFkYXRhQm94LnNldExpbmUoMywgJ1Jlc3RhcnRzICAgICAgICAgICAgICAnICsgcHJvYy5wbTJfZW52LnJlc3RhcnRfdGltZSk7XG4gICAgdGhpcy5tZXRhZGF0YUJveC5zZXRMaW5lKDQsICdVcHRpbWUgICAgICAgICAgICAgICAgJyArICgocHJvYy5wbTJfZW52LnBtX3VwdGltZSAmJiBwcm9jLnBtMl9lbnYuc3RhdHVzID09ICdvbmxpbmUnKSA/IHRpbWVTaW5jZShwcm9jLnBtMl9lbnYucG1fdXB0aW1lKSA6IDApKTtcbiAgICB0aGlzLm1ldGFkYXRhQm94LnNldExpbmUoNSwgJ1NjcmlwdCBwYXRoICAgICAgICAgICAnICsgcHJvYy5wbTJfZW52LnBtX2V4ZWNfcGF0aCk7XG4gICAgdGhpcy5tZXRhZGF0YUJveC5zZXRMaW5lKDYsICdTY3JpcHQgYXJncyAgICAgICAgICAgJyArIChwcm9jLnBtMl9lbnYuYXJncyA/ICh0eXBlb2YgcHJvYy5wbTJfZW52LmFyZ3MgPT0gJ3N0cmluZycgPyBKU09OLnBhcnNlKHByb2MucG0yX2Vudi5hcmdzLnJlcGxhY2UoLycvZywgJ1wiJykpOnByb2MucG0yX2Vudi5hcmdzKS5qb2luKCcgJykgOiAnTi9BJykpO1xuICAgIHRoaXMubWV0YWRhdGFCb3guc2V0TGluZSg3LCAnSW50ZXJwcmV0ZXIgICAgICAgICAgICcgKyBwcm9jLnBtMl9lbnYuZXhlY19pbnRlcnByZXRlcik7XG4gICAgdGhpcy5tZXRhZGF0YUJveC5zZXRMaW5lKDgsICdJbnRlcnByZXRlciBhcmdzICAgICAgJyArIChwcm9jLnBtMl9lbnYubm9kZV9hcmdzLmxlbmd0aCAhPSAwID8gcHJvYy5wbTJfZW52Lm5vZGVfYXJncyA6ICdOL0EnKSk7XG4gICAgdGhpcy5tZXRhZGF0YUJveC5zZXRMaW5lKDksICdFeGVjIG1vZGUgICAgICAgICAgICAgJyArIChwcm9jLnBtMl9lbnYuZXhlY19tb2RlID09ICdmb3JrX21vZGUnID8gJ3tib2xkfWZvcmt7L30nIDogJ3tibHVlLWZnfXtib2xkfWNsdXN0ZXJ7L30nKSk7XG4gICAgdGhpcy5tZXRhZGF0YUJveC5zZXRMaW5lKDEwLCAnTm9kZS5qcyB2ZXJzaW9uICAgICAgICcgKyBwcm9jLnBtMl9lbnYubm9kZV92ZXJzaW9uKTtcbiAgICB0aGlzLm1ldGFkYXRhQm94LnNldExpbmUoMTEsICd3YXRjaCAmIHJlbG9hZCAgICAgICAgJyArIChwcm9jLnBtMl9lbnYud2F0Y2ggPyAne2dyZWVuLWZnfXtib2xkfeKclHsvfScgOiAne3JlZC1mZ317Ym9sZH3inJh7L30nKSk7XG4gICAgdGhpcy5tZXRhZGF0YUJveC5zZXRMaW5lKDEyLCAnVW5zdGFibGUgcmVzdGFydHMgICAgICcgKyBwcm9jLnBtMl9lbnYudW5zdGFibGVfcmVzdGFydHMpO1xuXG4gICAgdGhpcy5tZXRhZGF0YUJveC5zZXRMaW5lKDEzLCAnQ29tbWVudCAgICAgICAgICAgICAgICcgKyAoKHByb2MucG0yX2Vudi52ZXJzaW9uaW5nKSA/IHByb2MucG0yX2Vudi52ZXJzaW9uaW5nLmNvbW1lbnQgOiAnTi9BJykpO1xuICAgIHRoaXMubWV0YWRhdGFCb3guc2V0TGluZSgxNCwgJ1JldmlzaW9uICAgICAgICAgICAgICAnICsgKChwcm9jLnBtMl9lbnYudmVyc2lvbmluZykgPyBwcm9jLnBtMl9lbnYudmVyc2lvbmluZy5yZXZpc2lvbiA6ICdOL0EnKSk7XG4gICAgdGhpcy5tZXRhZGF0YUJveC5zZXRMaW5lKDE1LCAnQnJhbmNoICAgICAgICAgICAgICAgICcgKyAoKHByb2MucG0yX2Vudi52ZXJzaW9uaW5nKSA/IHByb2MucG0yX2Vudi52ZXJzaW9uaW5nLmJyYW5jaCA6ICdOL0EnKSk7XG4gICAgdGhpcy5tZXRhZGF0YUJveC5zZXRMaW5lKDE2LCAnUmVtb3RlIHVybCAgICAgICAgICAgICcgKyAoKHByb2MucG0yX2Vudi52ZXJzaW9uaW5nKSA/IHByb2MucG0yX2Vudi52ZXJzaW9uaW5nLnVybCA6ICdOL0EnKSk7XG4gICAgdGhpcy5tZXRhZGF0YUJveC5kZWxldGVMaW5lKDE3KVxuICAgIHRoaXMubWV0YWRhdGFCb3guc2V0TGluZSgxNywgJ0xhc3QgdXBkYXRlICAgICAgICAgICAnICsgKChwcm9jLnBtMl9lbnYudmVyc2lvbmluZykgPyBwcm9jLnBtMl9lbnYudmVyc2lvbmluZy51cGRhdGVfdGltZSA6ICdOL0EnKSk7XG5cbiAgICBpZiAoT2JqZWN0LmtleXMocHJvYy5wbTJfZW52LmF4bV9tb25pdG9yKS5sZW5ndGggIT0gdGhpcy5tZXRyaWNzQm94Lml0ZW1zLmxlbmd0aCkge1xuICAgICAgdGhpcy5tZXRyaWNzQm94LmNsZWFySXRlbXMoKTtcbiAgICB9XG4gICAgdmFyIGogPSAwO1xuICAgIGZvciAodmFyIGtleSBpbiBwcm9jLnBtMl9lbnYuYXhtX21vbml0b3IpIHtcbiAgICAgIHZhciBtZXRyaWNfbmFtZSA9IHByb2MucG0yX2Vudi5heG1fbW9uaXRvcltrZXldLmhhc093blByb3BlcnR5KCd2YWx1ZScpID8gcHJvYy5wbTJfZW52LmF4bV9tb25pdG9yW2tleV0udmFsdWUgOiBwcm9jLnBtMl9lbnYuYXhtX21vbml0b3Jba2V5XVxuICAgICAgdmFyIG1ldHJpY191bml0ID0gcHJvYy5wbTJfZW52LmF4bV9tb25pdG9yW2tleV0uaGFzT3duUHJvcGVydHkoJ3VuaXQnKSA/IHByb2MucG0yX2Vudi5heG1fbW9uaXRvcltrZXldLnVuaXQgOiBudWxsXG4gICAgICB2YXIgcHJvYmUgPSBge2JvbGR9JHtrZXl9ey99IHt8fSAke21ldHJpY19uYW1lfSR7bWV0cmljX3VuaXQgPT0gbnVsbCA/ICcnIDogJyAnICsgbWV0cmljX3VuaXR9YFxuXG4gICAgICBpZiAodGhpcy5tZXRyaWNzQm94LmdldEl0ZW0oaikpIHtcbiAgICAgICAgdGhpcy5tZXRyaWNzQm94LnNldEl0ZW0oaiwgcHJvYmUpO1xuICAgICAgfVxuICAgICAgZWxzZSB7XG4gICAgICAgIHRoaXMubWV0cmljc0JveC5wdXNoSXRlbShwcm9iZSk7XG4gICAgICB9XG4gICAgICBqKys7XG4gICAgfVxuXG4gICAgdGhpcy5zY3JlZW4ucmVuZGVyKCk7XG4gIH1cblxuICByZXR1cm4gdGhpcztcbn1cblxuLyoqXG4gKiBQdXQgTG9nXG4gKiBAbWV0aG9kIGxvZ1xuICogQHBhcmFtIHt9IGRhdGFcbiAqIEByZXR1cm4gdGhpc1xuICovXG5EYXNoYm9hcmQubG9nID0gZnVuY3Rpb24odHlwZSwgZGF0YSkge1xuICB2YXIgdGhhdCA9IHRoaXM7XG5cbiAgaWYodHlwZW9mKHRoaXMubG9nTGluZXNbZGF0YS5wcm9jZXNzLnBtX2lkXSkgPT0gXCJ1bmRlZmluZWRcIil7XG4gICAgdGhpcy5sb2dMaW5lc1tkYXRhLnByb2Nlc3MucG1faWRdPVtdO1xuICB9XG4gIC8vIExvZ3MgY29sb3JzXG4gIHN3aXRjaCAodHlwZSkge1xuICAgIGNhc2UgJ1BNMic6XG4gICAgICB2YXIgY29sb3IgPSAne2JsdWUtZmd9JztcbiAgICAgIGJyZWFrO1xuICAgIGNhc2UgJ291dCc6XG4gICAgICB2YXIgY29sb3IgPSAne2dyZWVuLWZnfSc7XG4gICAgICBicmVhaztcbiAgICBjYXNlICdlcnInOlxuICAgICAgdmFyIGNvbG9yID0gJ3tyZWQtZmd9JztcbiAgICAgIGJyZWFrO1xuICAgIGRlZmF1bHQ6XG4gICAgICB2YXIgY29sb3IgPSAne3doaXRlLWZnfSc7XG4gIH1cblxuICB2YXIgbG9ncyA9IGRhdGEuZGF0YS5zcGxpdCgnXFxuJylcblxuICBsb2dzLmZvckVhY2goKGxvZykgPT4ge1xuICAgIGlmIChsb2cubGVuZ3RoID4gMCkge1xuICAgICAgdGhpcy5sb2dMaW5lc1tkYXRhLnByb2Nlc3MucG1faWRdLnB1c2goY29sb3IgKyBkYXRhLnByb2Nlc3MubmFtZSArICd7L30gPiAnICsgbG9nKVxuXG5cbiAgICAgIC8vcmVtb3ZpbmcgbG9ncyBpZiBsb25nZXIgdGhhbiBsaW1pdFxuICAgICAgbGV0IGNvdW50ID0gMDtcbiAgICAgIGxldCBtYXhfY291bnQgPSAwO1xuICAgICAgbGV0IGxlYWRpbmdfcHJvY2Vzc19pZCA9IC0xO1xuXG4gICAgICBmb3IodmFyIHByb2Nlc3NfaWQgaW4gdGhpcy5sb2dMaW5lcyl7XG4gICAgICAgIGNvdW50ICs9IHRoaXMubG9nTGluZXNbcHJvY2Vzc19pZF0ubGVuZ3RoO1xuICAgICAgICBpZiggdGhpcy5sb2dMaW5lc1twcm9jZXNzX2lkXS5sZW5ndGggPiBtYXhfY291bnQpe1xuICAgICAgICAgIGxlYWRpbmdfcHJvY2Vzc19pZCA9ICtwcm9jZXNzX2lkO1xuICAgICAgICAgIG1heF9jb3VudCA9IHRoaXMubG9nTGluZXNbcHJvY2Vzc19pZF0ubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICB9XG5cbiAgICAgIGlmIChjb3VudCA+IDIwMCkge1xuICAgICAgICB0aGlzLmxvZ0xpbmVzW2xlYWRpbmdfcHJvY2Vzc19pZF0uc2hpZnQoKVxuICAgICAgfVxuICAgIH1cbiAgfSlcblxuICByZXR1cm4gdGhpcztcbn1cblxubW9kdWxlLmV4cG9ydHMgPSBEYXNoYm9hcmQ7XG5cbmZ1bmN0aW9uIHRpbWVTaW5jZShkYXRlKSB7XG5cbiAgdmFyIHNlY29uZHMgPSBNYXRoLmZsb29yKG1vbWVudCgpLnVuaXgoKSAtIG1vbWVudChkYXRlKS51bml4KCkpO1xuXG4gIHZhciBpbnRlcnZhbCA9IE1hdGguZmxvb3Ioc2Vjb25kcyAvIDMxNTM2MDAwKTtcblxuICBpZiAoaW50ZXJ2YWwgPiAxKSB7XG4gICAgcmV0dXJuIGludGVydmFsICsgJ1knO1xuICB9XG4gIGludGVydmFsID0gTWF0aC5mbG9vcihzZWNvbmRzIC8gMjU5MjAwMCk7XG4gIGlmIChpbnRlcnZhbCA+IDEpIHtcbiAgICByZXR1cm4gaW50ZXJ2YWwgKyAnTSc7XG4gIH1cbiAgaW50ZXJ2YWwgPSBNYXRoLmZsb29yKHNlY29uZHMgLyA4NjQwMCk7XG4gIGlmIChpbnRlcnZhbCA+IDEpIHtcbiAgICByZXR1cm4gaW50ZXJ2YWwgKyAnRCc7XG4gIH1cbiAgaW50ZXJ2YWwgPSBNYXRoLmZsb29yKHNlY29uZHMgLyAzNjAwKTtcbiAgaWYgKGludGVydmFsID4gMSkge1xuICAgIHJldHVybiBpbnRlcnZhbCArICdoJztcbiAgfVxuICBpbnRlcnZhbCA9IE1hdGguZmxvb3Ioc2Vjb25kcyAvIDYwKTtcbiAgaWYgKGludGVydmFsID4gMSkge1xuICAgIHJldHVybiBpbnRlcnZhbCArICdtJztcbiAgfVxuICByZXR1cm4gTWF0aC5mbG9vcihzZWNvbmRzKSArICdzJztcbn1cblxuLyogQXJncyA6XG4gKiAgcCA6IFBlcmNlbnQgMCAtIDEwMFxuICogIHJnYl8gOiBBcnJheSBvZiByZ2IgWzI1NSwgMjU1LCAyNTVdXG4gKiBSZXR1cm4gOlxuICogIEhleGEgI0ZGRkZGRlxuICovXG5mdW5jdGlvbiBncmFkaWVudChwLCByZ2JfYmVnaW5uaW5nLCByZ2JfZW5kKSB7XG5cbiAgICB2YXIgdyA9IChwIC8gMTAwKSAqIDIgLSAxO1xuXG4gICAgdmFyIHcxID0gKHcgKyAxKSAvIDIuMDtcbiAgICB2YXIgdzIgPSAxIC0gdzE7XG5cbiAgICB2YXIgcmdiID0gW3BhcnNlSW50KChyZ2JfYmVnaW5uaW5nWzBdICogdzEgKyByZ2JfZW5kWzBdICogdzIpICsgXCJcIiksXG4gICAgICAgIHBhcnNlSW50KChyZ2JfYmVnaW5uaW5nWzFdICogdzEgKyByZ2JfZW5kWzFdICogdzIpICsgXCJcIiksXG4gICAgICAgICAgICBwYXJzZUludCgocmdiX2JlZ2lubmluZ1syXSAqIHcxICsgcmdiX2VuZFsyXSAqIHcyKSArIFwiXCIpXTtcblxuICAgIHJldHVybiBcIiNcIiArICgoMSA8PCAyNCkgKyAocmdiWzBdIDw8IDE2KSArIChyZ2JbMV0gPDwgOCkgKyByZ2JbMl0pLnRvU3RyaW5nKDE2KS5zbGljZSgxKTtcbn1cbiJdfQ==