"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _child_process = require("child_process");

var DockerMgmt = {};

function execDocker(cmd, cb) {
  var i = (0, _child_process.spawn)('docker', cmd, {
    stdio: 'inherit',
    env: process.env,
    shell: true
  });
  i.on('close', cb);
}

DockerMgmt.processCommand = function (PM2, start_id, select_id, action, cb) {
  PM2.Client.executeRemote('getSystemData', {}, function (err, sys_infos) {
    if (sys_infos.containers && sys_infos.containers.length == 0) return cb(new Error("Process ".concat(select_id, " not found")));
    var container = sys_infos.containers[select_id - start_id - 1];
    if (action == 'stopProcessId') execDocker(['stop', container.id], cb);
    if (action == 'deleteProcessId') execDocker(['rm', container.id], cb);
    if (action == 'restartProcessId') execDocker(['restart', container.id], cb);
  });
};

var _default = DockerMgmt;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9BUEkvRXh0cmFNZ210L0RvY2tlci50cyJdLCJuYW1lcyI6WyJEb2NrZXJNZ210IiwiZXhlY0RvY2tlciIsImNtZCIsImNiIiwiaSIsInN0ZGlvIiwiZW52IiwicHJvY2VzcyIsInNoZWxsIiwib24iLCJwcm9jZXNzQ29tbWFuZCIsIlBNMiIsInN0YXJ0X2lkIiwic2VsZWN0X2lkIiwiYWN0aW9uIiwiQ2xpZW50IiwiZXhlY3V0ZVJlbW90ZSIsImVyciIsInN5c19pbmZvcyIsImNvbnRhaW5lcnMiLCJsZW5ndGgiLCJFcnJvciIsImNvbnRhaW5lciIsImlkIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQ0E7O0FBQ0EsSUFBTUEsVUFBZSxHQUFHLEVBQXhCOztBQUVBLFNBQVNDLFVBQVQsQ0FBb0JDLEdBQXBCLEVBQXlCQyxFQUF6QixFQUE2QjtBQUMzQixNQUFJQyxDQUFDLEdBQUcsMEJBQU0sUUFBTixFQUFnQkYsR0FBaEIsRUFBcUI7QUFDM0JHLElBQUFBLEtBQUssRUFBRyxTQURtQjtBQUUzQkMsSUFBQUEsR0FBRyxFQUFFQyxPQUFPLENBQUNELEdBRmM7QUFHN0JFLElBQUFBLEtBQUssRUFBRztBQUhxQixHQUFyQixDQUFSO0FBTUFKLEVBQUFBLENBQUMsQ0FBQ0ssRUFBRixDQUFLLE9BQUwsRUFBY04sRUFBZDtBQUNEOztBQUVESCxVQUFVLENBQUNVLGNBQVgsR0FBNEIsVUFBU0MsR0FBVCxFQUFjQyxRQUFkLEVBQXdCQyxTQUF4QixFQUFtQ0MsTUFBbkMsRUFBMkNYLEVBQTNDLEVBQStDO0FBQ3pFUSxFQUFBQSxHQUFHLENBQUNJLE1BQUosQ0FBV0MsYUFBWCxDQUF5QixlQUF6QixFQUEwQyxFQUExQyxFQUE4QyxVQUFDQyxHQUFELEVBQU1DLFNBQU4sRUFBb0I7QUFDaEUsUUFBSUEsU0FBUyxDQUFDQyxVQUFWLElBQXdCRCxTQUFTLENBQUNDLFVBQVYsQ0FBcUJDLE1BQXJCLElBQStCLENBQTNELEVBQ0UsT0FBT2pCLEVBQUUsQ0FBQyxJQUFJa0IsS0FBSixtQkFBcUJSLFNBQXJCLGdCQUFELENBQVQ7QUFDRixRQUFJUyxTQUFTLEdBQUdKLFNBQVMsQ0FBQ0MsVUFBVixDQUFxQk4sU0FBUyxHQUFHRCxRQUFaLEdBQXVCLENBQTVDLENBQWhCO0FBQ0EsUUFBSUUsTUFBTSxJQUFJLGVBQWQsRUFDRWIsVUFBVSxDQUFDLENBQUMsTUFBRCxFQUFTcUIsU0FBUyxDQUFDQyxFQUFuQixDQUFELEVBQXlCcEIsRUFBekIsQ0FBVjtBQUNGLFFBQUlXLE1BQU0sSUFBSSxpQkFBZCxFQUNFYixVQUFVLENBQUMsQ0FBQyxJQUFELEVBQU9xQixTQUFTLENBQUNDLEVBQWpCLENBQUQsRUFBdUJwQixFQUF2QixDQUFWO0FBQ0YsUUFBSVcsTUFBTSxJQUFJLGtCQUFkLEVBQ0ViLFVBQVUsQ0FBQyxDQUFDLFNBQUQsRUFBWXFCLFNBQVMsQ0FBQ0MsRUFBdEIsQ0FBRCxFQUE0QnBCLEVBQTVCLENBQVY7QUFDSCxHQVZEO0FBV0QsQ0FaRDs7ZUFjZUgsVSIsInNvdXJjZXNDb250ZW50IjpbIlxyXG5pbXBvcnQgeyBzcGF3biB9IGZyb20gJ2NoaWxkX3Byb2Nlc3MnO1xyXG5jb25zdCBEb2NrZXJNZ210OiBhbnkgPSB7fVxyXG5cclxuZnVuY3Rpb24gZXhlY0RvY2tlcihjbWQsIGNiKSB7XHJcbiAgdmFyIGkgPSBzcGF3bignZG9ja2VyJywgY21kLCB7XHJcbiAgICBzdGRpbyA6ICdpbmhlcml0JyxcclxuICAgIGVudjogcHJvY2Vzcy5lbnYsXHJcblx0XHRzaGVsbCA6IHRydWVcclxuICB9KVxyXG5cclxuICBpLm9uKCdjbG9zZScsIGNiKVxyXG59XHJcblxyXG5Eb2NrZXJNZ210LnByb2Nlc3NDb21tYW5kID0gZnVuY3Rpb24oUE0yLCBzdGFydF9pZCwgc2VsZWN0X2lkLCBhY3Rpb24sIGNiKSB7XHJcbiAgUE0yLkNsaWVudC5leGVjdXRlUmVtb3RlKCdnZXRTeXN0ZW1EYXRhJywge30sIChlcnIsIHN5c19pbmZvcykgPT4ge1xyXG4gICAgaWYgKHN5c19pbmZvcy5jb250YWluZXJzICYmIHN5c19pbmZvcy5jb250YWluZXJzLmxlbmd0aCA9PSAwKVxyXG4gICAgICByZXR1cm4gY2IobmV3IEVycm9yKGBQcm9jZXNzICR7c2VsZWN0X2lkfSBub3QgZm91bmRgKSlcclxuICAgIHZhciBjb250YWluZXIgPSBzeXNfaW5mb3MuY29udGFpbmVyc1tzZWxlY3RfaWQgLSBzdGFydF9pZCAtIDFdXHJcbiAgICBpZiAoYWN0aW9uID09ICdzdG9wUHJvY2Vzc0lkJylcclxuICAgICAgZXhlY0RvY2tlcihbJ3N0b3AnLCBjb250YWluZXIuaWRdLCBjYilcclxuICAgIGlmIChhY3Rpb24gPT0gJ2RlbGV0ZVByb2Nlc3NJZCcpXHJcbiAgICAgIGV4ZWNEb2NrZXIoWydybScsIGNvbnRhaW5lci5pZF0sIGNiKVxyXG4gICAgaWYgKGFjdGlvbiA9PSAncmVzdGFydFByb2Nlc3NJZCcpXHJcbiAgICAgIGV4ZWNEb2NrZXIoWydyZXN0YXJ0JywgY29udGFpbmVyLmlkXSwgY2IpXHJcbiAgfSlcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgRG9ja2VyTWdtdFxyXG4iXX0=