"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _fs = _interopRequireDefault(require("fs"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

var getUsers = function getUsers() {
  return _fs["default"].readFileSync('/etc/passwd').toString().split('\n').filter(function (user) {
    return user.length && user[0] != '#';
  }).reduce(function (map, user) {
    var fields = user.split(':');
    map[fields[0]] = map[fields[2]] = {
      username: fields[0],
      password: fields[1],
      userId: fields[2],
      groupId: fields[3],
      name: fields[4].split(',')[0],
      homedir: fields[5],
      shell: fields[6]
    };
    return map;
  }, {});
};

var getGroups = function getGroups(cb) {
  var groups;

  try {
    groups = _fs["default"].readFileSync('/etc/group');
  } catch (e) {
    return e;
  }

  return groups.toString().split('\n').filter(function (group) {
    return group.length && group[0] != '#';
  }).reduce(function (map, group) {
    var fields = group.split(':');
    map[fields[0]] = map[fields[2]] = {
      name: fields[0],
      password: fields[1],
      id: fields[2],
      members: fields[3].split(',')
    };
    return map;
  }, {});
};

var _default = {
  getUsers: getUsers,
  getGroups: getGroups
};
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy90b29scy9wYXNzd2QudHMiXSwibmFtZXMiOlsiZ2V0VXNlcnMiLCJmcyIsInJlYWRGaWxlU3luYyIsInRvU3RyaW5nIiwic3BsaXQiLCJmaWx0ZXIiLCJ1c2VyIiwibGVuZ3RoIiwicmVkdWNlIiwibWFwIiwiZmllbGRzIiwidXNlcm5hbWUiLCJwYXNzd29yZCIsInVzZXJJZCIsImdyb3VwSWQiLCJuYW1lIiwiaG9tZWRpciIsInNoZWxsIiwiZ2V0R3JvdXBzIiwiY2IiLCJncm91cHMiLCJlIiwiZ3JvdXAiLCJpZCIsIm1lbWJlcnMiXSwibWFwcGluZ3MiOiI7Ozs7Ozs7QUFDQTs7OztBQUVBLElBQUlBLFFBQVEsR0FBRyxTQUFYQSxRQUFXLEdBQVc7QUFDeEIsU0FBT0MsZUFBR0MsWUFBSCxDQUFnQixhQUFoQixFQUNKQyxRQURJLEdBRUpDLEtBRkksQ0FFRSxJQUZGLEVBR0pDLE1BSEksQ0FHRyxVQUFVQyxJQUFWLEVBQWdCO0FBQ3RCLFdBQU9BLElBQUksQ0FBQ0MsTUFBTCxJQUFlRCxJQUFJLENBQUMsQ0FBRCxDQUFKLElBQVcsR0FBakM7QUFDRCxHQUxJLEVBTUpFLE1BTkksQ0FNRyxVQUFTQyxHQUFULEVBQWNILElBQWQsRUFBb0I7QUFDMUIsUUFBSUksTUFBTSxHQUFHSixJQUFJLENBQUNGLEtBQUwsQ0FBVyxHQUFYLENBQWI7QUFFQUssSUFBQUEsR0FBRyxDQUFDQyxNQUFNLENBQUMsQ0FBRCxDQUFQLENBQUgsR0FBaUJELEdBQUcsQ0FBQ0MsTUFBTSxDQUFDLENBQUQsQ0FBUCxDQUFILEdBQWlCO0FBQ2hDQyxNQUFBQSxRQUFRLEVBQUdELE1BQU0sQ0FBQyxDQUFELENBRGU7QUFFaENFLE1BQUFBLFFBQVEsRUFBR0YsTUFBTSxDQUFDLENBQUQsQ0FGZTtBQUdoQ0csTUFBQUEsTUFBTSxFQUFHSCxNQUFNLENBQUMsQ0FBRCxDQUhpQjtBQUloQ0ksTUFBQUEsT0FBTyxFQUFHSixNQUFNLENBQUMsQ0FBRCxDQUpnQjtBQUtoQ0ssTUFBQUEsSUFBSSxFQUFHTCxNQUFNLENBQUMsQ0FBRCxDQUFOLENBQVVOLEtBQVYsQ0FBZ0IsR0FBaEIsRUFBcUIsQ0FBckIsQ0FMeUI7QUFNaENZLE1BQUFBLE9BQU8sRUFBR04sTUFBTSxDQUFDLENBQUQsQ0FOZ0I7QUFPaENPLE1BQUFBLEtBQUssRUFBR1AsTUFBTSxDQUFDLENBQUQ7QUFQa0IsS0FBbEM7QUFVQSxXQUFPRCxHQUFQO0FBQ0QsR0FwQkksRUFvQkYsRUFwQkUsQ0FBUDtBQXFCRCxDQXRCRDs7QUF3QkEsSUFBSVMsU0FBUyxHQUFHLFNBQVpBLFNBQVksQ0FBU0MsRUFBVCxFQUFhO0FBQzNCLE1BQUlDLE1BQUo7O0FBRUEsTUFBSTtBQUNGQSxJQUFBQSxNQUFNLEdBQUduQixlQUFHQyxZQUFILENBQWdCLFlBQWhCLENBQVQ7QUFDRCxHQUZELENBRUUsT0FBTW1CLENBQU4sRUFBUztBQUNULFdBQU9BLENBQVA7QUFDRDs7QUFFRCxTQUFPRCxNQUFNLENBQ1ZqQixRQURJLEdBRUpDLEtBRkksQ0FFRSxJQUZGLEVBR0pDLE1BSEksQ0FHRyxVQUFVaUIsS0FBVixFQUFpQjtBQUN2QixXQUFPQSxLQUFLLENBQUNmLE1BQU4sSUFBZ0JlLEtBQUssQ0FBQyxDQUFELENBQUwsSUFBWSxHQUFuQztBQUNELEdBTEksRUFNSmQsTUFOSSxDQU1HLFVBQVNDLEdBQVQsRUFBY2EsS0FBZCxFQUFxQjtBQUMzQixRQUFJWixNQUFNLEdBQUdZLEtBQUssQ0FBQ2xCLEtBQU4sQ0FBWSxHQUFaLENBQWI7QUFDQUssSUFBQUEsR0FBRyxDQUFDQyxNQUFNLENBQUMsQ0FBRCxDQUFQLENBQUgsR0FBaUJELEdBQUcsQ0FBQ0MsTUFBTSxDQUFDLENBQUQsQ0FBUCxDQUFILEdBQWlCO0FBQ2hDSyxNQUFBQSxJQUFJLEVBQUdMLE1BQU0sQ0FBQyxDQUFELENBRG1CO0FBRWhDRSxNQUFBQSxRQUFRLEVBQUdGLE1BQU0sQ0FBQyxDQUFELENBRmU7QUFHaENhLE1BQUFBLEVBQUUsRUFBR2IsTUFBTSxDQUFDLENBQUQsQ0FIcUI7QUFJaENjLE1BQUFBLE9BQU8sRUFBR2QsTUFBTSxDQUFDLENBQUQsQ0FBTixDQUFVTixLQUFWLENBQWdCLEdBQWhCO0FBSnNCLEtBQWxDO0FBTUEsV0FBT0ssR0FBUDtBQUNELEdBZkksRUFlRixFQWZFLENBQVA7QUFnQkQsQ0F6QkQ7O2VBMkJlO0FBQ2JULEVBQUFBLFFBQVEsRUFBUkEsUUFEYTtBQUVia0IsRUFBQUEsU0FBUyxFQUFUQTtBQUZhLEMiLCJzb3VyY2VzQ29udGVudCI6WyJcclxuaW1wb3J0IGZzIGZyb20gJ2ZzJ1xyXG5cclxudmFyIGdldFVzZXJzID0gZnVuY3Rpb24oKSB7XHJcbiAgcmV0dXJuIGZzLnJlYWRGaWxlU3luYygnL2V0Yy9wYXNzd2QnKVxyXG4gICAgLnRvU3RyaW5nKClcclxuICAgIC5zcGxpdCgnXFxuJylcclxuICAgIC5maWx0ZXIoZnVuY3Rpb24gKHVzZXIpIHtcclxuICAgICAgcmV0dXJuIHVzZXIubGVuZ3RoICYmIHVzZXJbMF0gIT0gJyMnO1xyXG4gICAgfSlcclxuICAgIC5yZWR1Y2UoZnVuY3Rpb24obWFwLCB1c2VyKSB7XHJcbiAgICAgIHZhciBmaWVsZHMgPSB1c2VyLnNwbGl0KCc6Jyk7XHJcblxyXG4gICAgICBtYXBbZmllbGRzWzBdXSA9IG1hcFtmaWVsZHNbMl1dID0ge1xyXG4gICAgICAgIHVzZXJuYW1lIDogZmllbGRzWzBdLFxyXG4gICAgICAgIHBhc3N3b3JkIDogZmllbGRzWzFdLFxyXG4gICAgICAgIHVzZXJJZCA6IGZpZWxkc1syXSxcclxuICAgICAgICBncm91cElkIDogZmllbGRzWzNdLFxyXG4gICAgICAgIG5hbWUgOiBmaWVsZHNbNF0uc3BsaXQoJywnKVswXSxcclxuICAgICAgICBob21lZGlyIDogZmllbGRzWzVdLFxyXG4gICAgICAgIHNoZWxsIDogZmllbGRzWzZdXHJcbiAgICAgIH07XHJcblxyXG4gICAgICByZXR1cm4gbWFwXHJcbiAgICB9LCB7fSlcclxufVxyXG5cclxudmFyIGdldEdyb3VwcyA9IGZ1bmN0aW9uKGNiKSB7XHJcbiAgdmFyIGdyb3Vwc1xyXG5cclxuICB0cnkge1xyXG4gICAgZ3JvdXBzID0gZnMucmVhZEZpbGVTeW5jKCcvZXRjL2dyb3VwJylcclxuICB9IGNhdGNoKGUpIHtcclxuICAgIHJldHVybiBlXHJcbiAgfVxyXG5cclxuICByZXR1cm4gZ3JvdXBzXHJcbiAgICAudG9TdHJpbmcoKVxyXG4gICAgLnNwbGl0KCdcXG4nKVxyXG4gICAgLmZpbHRlcihmdW5jdGlvbiAoZ3JvdXApIHtcclxuICAgICAgcmV0dXJuIGdyb3VwLmxlbmd0aCAmJiBncm91cFswXSAhPSAnIyc7XHJcbiAgICB9KVxyXG4gICAgLnJlZHVjZShmdW5jdGlvbihtYXAsIGdyb3VwKSB7XHJcbiAgICAgIHZhciBmaWVsZHMgPSBncm91cC5zcGxpdCgnOicpO1xyXG4gICAgICBtYXBbZmllbGRzWzBdXSA9IG1hcFtmaWVsZHNbMl1dID0ge1xyXG4gICAgICAgIG5hbWUgOiBmaWVsZHNbMF0sXHJcbiAgICAgICAgcGFzc3dvcmQgOiBmaWVsZHNbMV0sXHJcbiAgICAgICAgaWQgOiBmaWVsZHNbMl0sXHJcbiAgICAgICAgbWVtYmVycyA6IGZpZWxkc1szXS5zcGxpdCgnLCcpXHJcbiAgICAgIH07XHJcbiAgICAgIHJldHVybiBtYXA7XHJcbiAgICB9LCB7fSlcclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQge1xyXG4gIGdldFVzZXJzLFxyXG4gIGdldEdyb3Vwc1xyXG59XHJcbiJdfQ==